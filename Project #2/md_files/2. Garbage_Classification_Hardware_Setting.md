# 2022-1_DTA_Garbage_Classification

β€‹	

# Garbage Classification Hardware Setting

2022.06.17. Fri

β€‹	

Handong Global University, School of Mechanical and Control Engineering, 2022-1 DigitalTwin&Automation

21500018 | κ°•ν¬μ¤

21700791 | ν™μ„Έν„

21900726 | μ§€ν„λΉ

β€‹	
## Manipulator INDY-10 & Gripper VGC10.
Manipulator λ¥Ό μ‚¬μ©ν•κΈ° μ„ν•΄μ„λ” λ΅λ΄‡μ— μ „μ›μ„ κ³µκΈ‰ν•κ³ , μ›ν•λ” κ·Έλ¦¬νΌλ¥Ό μ¥μ°©μ‹ν‚¤λ” μΌλ ¨μ κ³Όμ •μ΄ ν•„μ”ν•©λ‹λ‹¤. 

λ³Έ ν”„λ΅μ νΈμ—μ„ μ‚¬μ©ν• **Manipulator(INDY-10)** κ³Ό **Gripper (VGC10)** μ κµ¬λ™ λ° μ—°κ²° λ°©λ²•μ€ **[λ΅λ΄‡ μ—°κ²° λ° κ·Έλ¦¬νΌ μ—°κ²°](https://github.com/Yjinsu/Digital_Twin_and_Automation/blob/main/Project%232/md_files/Tutorial%20-%20Manipulator%20INDY-10%20%26%20Gripper%20VGC10.md)** μ—μ„ ν™•μΈ κ°€λ¥ν•©λ‹λ‹¤.


β€‹	

## Conveyor Belt

λ³Έ ν”„λ΅μ νΈμ—μ„ μ‚¬μ©ν• **WLKATA Mirobot Conveyor Belt** μ…λ‹λ‹¤. μ΄λ™ λ²”μ„λ” **500mm** μ…λ‹λ‹¤ 

<p align="center">
	<img src="https://user-images.githubusercontent.com/107540262/174435039-331110a1-c851-499c-bb90-c18dd514e5e6.png" width="50%" height="50%"/>
</p>


WLKATA Mirobot Conveyor Belt μ— μ‚¬μ©λ μ¤νƒνΌλ¨ν„°λ” μ¤νƒ­κ°μ΄ **1.8λ„** μΈ **λ°”μ΄ν΄λΌ** μ¤νƒνΌλ¨ν„° **42HS4013A4** μ…λ‹λ‹¤. Spec Sheet λ” μ•„λμ™€ κ°™μµλ‹λ‹¤

μ •κ²© μ „μ••μ€ **3.25[V]**, μ •κ²© μ „λ¥λ” **1.3[A]** μ…λ‹λ‹¤. ν•΄λ‹Ή μ „μ••κ³Ό μ „λ¥λ¥Ό μ¶©μ΅±μ‹μΌ μ£Όμ–΄μ•Ό μ¤νƒνΌ λ¨ν„°κ°€ μ •μƒμ μΌλ΅ λ™μ‘ν•©λ‹λ‹¤. 

<p align="center">
	<img src="https://user-images.githubusercontent.com/107540262/174435051-f7082405-ba2b-491b-84e7-1025ab51c4bf.png" width="50%" height="50%"/>
</p>


λ―Έλ΅λ΄‡μ Extender Box μ—†μ΄ μ¤νƒνΌλ¨ν„°λ¥Ό λ™μ‘μ‹μΌμ•Ό ν•κΈ° λ•λ¬Έμ— μ¤νƒνΌ λ¨ν„°μ μ¶λ ¥μ„ μ΄ μ–΄λ–¤ κ²ƒμ„ μλ―Έν•λ”μ§€ νμ•…ν•  ν•„μ”κ°€ μμµλ‹λ‹¤. **[Extender Box User Manual](https://document.wlkata.com/?doc=/wlkata-mirobot-user-manual-platinum/2-multifunctional-extender-box-user-manual/)** λ¥Ό ν†µν•΄ A+,A-,B+,B- μ μμ„λ΅ κ²°μ„ ν•λ©΄ λλ” κ²ƒμ„ ν™•μΈν–μµλ‹λ‹¤.

<p align="center">
	<img src="https://user-images.githubusercontent.com/107540262/174437363-e2d50a45-3b60-40c4-826c-f02aac85edfa.png" width="70%" height="70%"/>
</p>


## MOTOR DRIVER (MSD-224) ##

λ¨ν„°ν•€μ— MCU ν•€μ„ μ§μ ‘ μ—°κ²°ν•λ©΄ λ¨ν„°κ°€ κΊΌμ§ λ• μƒκΈ°λ” μ—­κΈ°μ „λ ¥μΌλ΅ μΈν•΄ MCU κ³ μ¥ μ„ν—μ΄ μμΌλ―€λ΅ μ¤νƒνΌλ¨ν„°λ¥Ό λ™μ‘μ‹ν‚¤κΈ° μ„ν•΄μ„λ” λ¨ν„° λ“λΌμ΄λ²„κ°€ ν•„μ”ν•©λ‹λ‹¤. μ‚¬μ©ν• λ¨ν„° λ“λΌμ΄λ²„λ” **MSD-224** (BIPOLAR STEPPING MOTOR DRIVER)μ…λ‹λ‹¤.
μ¤ν™μ‹νΈλ” λ”°λ΅ μ—†μ§€λ§ **[λ””λ°”μ΄μ¤ λ§νΈ - μ ν’ μƒμ„Έμ„¤λ…](https://www.devicemart.co.kr/goods/view?no=12758654#goods_description)** μ—μ„ μ¤ν™μ„ ν™•μΈν•  μ μμµλ‹λ‹¤.

μ‚¬μ© μ „μ••μ€ **9[V]~24[V]** μ¶λ ¥ μ „λ¥ **4[A/Phase]**  CLK Frequency λ” **~200k[Hz]** μ…λ‹λ‹¤.

<p align="center">
	<img src="https://user-images.githubusercontent.com/107540262/174435098-f2e026a5-1aa9-4972-8e93-c3e702f49290.png" width="50%" height="50%"/>
</p>

λ¨ν„° λ“λΌμ΄λ²„μ—λ” μ„λ΅ μ¬λ¦¬λ©΄ OFF μ•„λλ΅ λ‚΄λ¦¬λ©΄ ON μΈ 6κ°μ DIP μ¤μ„μΉκ°€ μμµλ‹λ‹¤. ν•΄λ‹Ή μ¤μ„μΉλ¥Ό μ΅°μ‘μ„ ν†µν•΄ μ›ν•λ” μ¶λ ¥ μ „λ¥μ™€ κµ¬λ™ λ°©μ‹μ„ μ„ νƒν•©λ‹λ‹¤. 
λ³Έ ν”„λ΅μ νΈμ κ²½μ° μ¤νƒνΌλ¨ν„°μ μ •κ²© μ „λ¥λ¥Ό κ³ λ ¤ν•μ—¬ μ¶λ ¥ μ „λ¥ **2.5[A]**, λ†’μ€ ν† ν¬λ¥Ό μ‚¬μ©ν•κΈ° μ„ν•΄ **Full-Step(Microstep 1)** μ„ μ‚¬μ©ν•μ€μµλ‹λ‹¤.

<p align="center">
	<img src="https://user-images.githubusercontent.com/107540262/174437086-bddcf910-9a12-4efe-be18-635fe540e3bf.png" width="45%" height="45%"/>
</p>


νλ΅λ„λ” λ‹¤μκ³Ό κ°™μµλ‹λ‹¤. μ“°λ κΈ°λ” ν• λ°©ν–¥μΌλ΅λ§ μ΄λ°λλ―€λ΅ λ°©ν–¥μ„ λ°”κΏ”μ¤„ ν•„μ”κ°€ μ—†κΈ° λ•λ¬Έμ— ENA, DIR μ…λ ¥μ€ μ‚¬μ©ν•μ§€ μ•μ•μµλ‹λ‹¤.

**PUL+** μ—λ” MCU μ **PWM** μ¶λ ¥μ„, PUL- μ—λ” **MCU**μ **GND** λ¥Ό μΈκ°€ν•©λ‹λ‹¤. νμ›μ„ν”λΌμ΄λ¥Ό ν†µν•΄ **Vcc** μ— **11[V]** , **GND** μ— **GND** λ¥Ό μΈκ°€ν•©λ‹λ‹¤. 


<p align="center">
	<img src="https://user-images.githubusercontent.com/107540262/174437297-be9e6bd8-d3e0-48a2-901a-29a4d579bf24.png" width="45%" height="45%"/>
</p>



## MCU (STM32F411RE) ##

λ¨ν„° λ“λΌμ΄λ²„μ PUL+ ν•€μ— PWM μ…λ ¥μ„ μ£ΌκΈ° μ„ν•΄ MCU (STM32F411RE) λ¥Ό μ‚¬μ©ν•μ€μµλ‹λ‹¤.

<p align="center">
	<img src="https://user-images.githubusercontent.com/107540262/174435091-88cb7845-5a37-4667-ad5e-e03695cfb9c0.png" width="30%" height="30%"/>
</p>

λ³Έ ν”„λ΅μ νΈλ¥Ό λ™μΌν•κ² μν–‰ν•κΈ° μ„ν•΄μ„λ” **[1. Conveyor_Belt_Driving ](https://github.com/Hongsehyun/2022_1_DigitalTwin_Automation/tree/main/Project%20%232/1.%20Conveyor_Belt_Driving)**  μ λ¨λ“  νμΌκ³Ό **[Keil uVision5](https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=chgy2131&logNo=220334845888&view=img_8
)** λ‹¤μ΄λ΅λ“κ°€ ν•„μ”ν•©λ‹λ‹¤. μ΄λ• Keil uVision5 λ‹¤μ΄λ΅λ“ κ³Όμ •μ—μ„ Pack Installer μ‹λ¦¬μ¦λ¥Ό κ²μ‹κΈ€κ³Ό λ‹¬λ¦¬ **STMicroelectronics - STM32F4 Series - STM32F411 - STM32F411RE** λ¥Ό μ„ νƒν•΄ μ£Όμ–΄μ•Ό ν•©λ‹λ‹¤. λν• λ¨λ“  ν©μ„ μ„¤μΉν•΄λ„ λ¬΄λ°©ν•μ§€λ§, **μ•„λ λ„¤ κ°μ ν©λ§ μ„¤μΉ**ν•λ©΄ μ •μƒμ μΈ μ‘λ™μ΄ κ°€λ¥ν•©λ‹λ‹¤.


<p align="center">
	<img src="https://user-images.githubusercontent.com/107540262/174462286-72a1ad71-95a6-428b-a381-d93fbf2ecffb.png" width="50%" height="50%"/>
</p>


ν•€λ²νΈλ¥Ό ν™•μΈν•κ³  νλ΅λ¥Ό μ—°κ²°ν•©λ‹λ‹¤.

<p align="center">
	<img src="https://user-images.githubusercontent.com/107540262/174462511-b0eaeb8f-8084-46f5-9e24-db78337917ab.png" width="50%" height="50%"/>
</p>

<p align="center">
	<img src="https://user-images.githubusercontent.com/107540262/174438823-81024f1c-9058-40e0-8036-ad3265e6e6be.png" width="70%" height="70%"/>
</p>



**PWM_init ν•¨μ**λ¥Ό ν†µν•΄ **μ•„μ›ƒν’‹ ν•€**μ„ μ •μν•κ³ 
**PWM_period_us**     ν•¨μλ¥Ό ν†µν•΄ **PWM μ£ΌκΈ°**λ¥Ό μ •μν•  μ μμµλ‹λ‹¤.

**π‘π‘π‘=π‘“Γ—60Γ—(π‘†π‘΅π‘’π‘ π΄π‘›π‘”π‘™π‘’)/360** μ μ‹μ—μ„ κµ¬ν• μ£Όνμλ¥Ό ν†µν•΄ PWM μ ν„μ¤λ¥Ό μ μ–΄ν•μ—¬ μ¤νƒνΌλ¨ν„°λ¥Ό μ›ν•λ” μ†λ„λ΅ νμ „μ‹ν‚¬ μ μμµλ‹λ‹¤.

λ³Έ ν”„λ΅μ νΈλ” 1250[us]μ μ£ΌκΈ° μ¦‰, **800[Hz]** μ PWM μ„ μΈκ°€ν•μ—¬ **240[RPM]** μ μ†λ„λ΅ μ¤νƒνΌλ¨ν„°λ¥Ό λ™μ‘μ‹μΌ°μµλ‹λ‹¤. 

<p align="center">
	<img src="https://user-images.githubusercontent.com/107540262/174461353-c4c208d2-495b-4e3f-ab11-be69aef6cea6.png" width="70%" height="70%"/>
</p>




## λ™μΌν• ν•λ“μ›¨μ–΄ (μ»¨λ² μ΄μ–΄ λ²¨νΈ, MCU, λ¨ν„°λ“λΌμ΄λ²„) λ¥Ό μ‚¬μ©ν•μ§€ μ•λ” κ²½μ° 
μ»¨λ² μ΄μ–΄ λ²¨νΈμ— μ‚¬μ©λλ” **μ¤νƒνΌλ¨ν„°μ μ‚¬μ–‘**μ— λ”°λΌ **λ¨ν„°λ“λΌμ΄λ²„μ μΆ…λ¥**, μ™Έλ¶€ μ „μ••μΈ **νμ›μ„ν”λΌμ΄μ μ¶λ ¥κ°’**, MCU λ¥Ό ν†µν•΄ μ μ–΄ν•λ” **PWM μ νλΌλ―Έν„°**κ°€ λ‹¬λΌμ§‘λ‹λ‹¤.
λ¨ν„° λ“λΌμ΄λ²„ μ¶λ ¥ μ „λ¥κ°€ μ»¨λ² μ΄μ–΄ λ²¨νΈμ μ •κ²© μ „λ¥λ³΄λ‹¤ λ†’μ•„μ•Ό ν•λ©°, λ¨ν„° λ“λΌμ΄λ²„μ μ™Έλ¶€ μ „μ••μ€ λ€μ²΄λ΅ μ¤νƒνΌλ¨ν„° μ •κ²© μ „μ••μ 3~5λ°°λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤. 
λν• MCU μ—†μ΄ λ¨ν„°λ“λΌμ΄λ²„λ§μΌλ΅λ„ μ¤νƒνΌλ¨ν„°λ¥Ό λ™μ‘μ‹ν‚¬ μ μμµλ‹λ‹¤. PUL ν•€μ— **Function Generator μ‚¬κ°ν μ¶λ ¥**μ„ μΈκ°€ν•λ©΄ λ™μΌν• λ™μ‘μ΄ κ°€λ¥ν•©λ‹λ‹¤.


ν•΄λ‹Ή μ¤νƒνΌλ¨ν„°μ—λ” μ „λ¥κ°€ λ¶€μ΅±ν•μ—¬ μ‚¬μ©ν•μ§€ μ•μ•μΌλ‚, μΌλ°μ μΌλ΅ μ‚¬μ©ν•λ” MCU μΈ **μ•„λ‘μ΄λ…Έ μ°λ…Έ**μ™€ **μ•„λ‘μ΄λ…Έ μ‰΄λ“**λ¥Ό μ‚¬μ©ν•μ—¬ μ¤νƒνΌλ¨ν„°λ¥Ό λ™μ‘μ‹ν‚¤λ” λ°©λ²•μ€ λ‹¤μκ³Ό κ°™μµλ‹λ‹¤. 
ν•΄λ‹Ή μ½”λ“λ” κ° **μ‰΄λ“μ μ¶λ ¥μ „λ¥λ³΄λ‹¤ μ •κ²©μ „λ¥κ°€ λ‚®κ±°λ‚ κ°™μ€ μ¤νƒνΌ λ¨ν„°**μ—λ§ μ‚¬μ© κ°€λ¥ν•©λ‹λ‹¤. 
μμ„Έν• μ¤ν™μ‹νΈ λ° μ‰΄λ“ μ‚¬μ©λ°©λ²•μ€  **[Shield v1.2](https://www.adafruit.com/product/81)**,  **[Shield v2](https://www.adafruit.com/product/1438)** μ—μ„ ν™•μΈ κ°€λ¥ν•©λ‹λ‹¤

<p align="center">
	<img src="https://user-images.githubusercontent.com/107540262/174472170-12ba25c1-893b-494b-ae1b-8938349fcf16.png" width="80%" height="80%"/>
</p>


#### μ•„λ‘μ΄λ…Έ ν”„λ΅κ·Έλ¨ μ„¤μΉ λ° μ½”λ“ λ‹¤μ΄λ΅λ“
1. **[μ•„λ‘μ΄λ…Έ IDE](https://www.adafruit.com/product/81)** λ¥Ό μ„¤μΉν•©λ‹λ‹¤.
2. λ¨ν„° μ‰΄λ“ μΆ…λ¥μ— λ”°λΌ **[Shield v1.2](https://github.com/adafruit/Adafruit-Motor-Shield-library)**,  **[Shield v2](https://github.com/adafruit/Adafruit_Motor_Shield_V2_Library)** κΉƒν—λΈμ— μ ‘μ†ν•©λ‹λ‹¤. ν‘μ‹λ ν—¤λ” νμΌκ³Ό μ†μ¤ νμΌμ„ λ‹¤μ΄λ΅λ“ν•©λ‹λ‹¤.

<p align="center">
	<img src="https://user-images.githubusercontent.com/107540262/174472787-7f7c62e0-2268-4a3f-9e27-887c4a36dad6.png" width="80%" height="80%"/>
</p>

3. λ‹¤μ΄λ΅λ“ν• ν—¤λ”μ™€ μ†μ¤ νμΌμ„ **[μ•„λ‘μ΄λ…Έ λΌμ΄λΈλ¬λ¦¬ ](https://blog.naver.com/no1_devicemart/221504629709)** μ— μ¶”κ°€ν•©λ‹λ‹¤.

4. ν•΄λ‹Ή λΌμ΄λΈλ¬λ¦¬μ ν•μ„ ν΄λ”λ΅ λ“¤μ–΄κ°€ **StepperTest.ino** νμΌμ„ λ‹¤μ΄λ΅λ“ ν•©λ‹λ‹¤.


<p align="center">
	<img src="https://user-images.githubusercontent.com/107540262/174472880-c149eb1b-a988-4e17-a7d0-331905c8e28c.png" width="80%" height="80%"/>
</p>

5. μ•„λ‘μ΄λ…Έ IDE λ¥Ό μ‹¤ν–‰μ‹ν‚¤κ³  4μ—μ„ λ°›μ€ ino νμΌμ„ μ»΄νμΌ ν›„, μ•„λ‘μ΄λ…Έμ— μ—…λ΅λ“ν•©λ‹λ‹¤. μ¤νƒνΌλ¨ν„°κ°€ μ •μƒμ μΌλ΅ λ™μ‘ν•λ” κ²ƒμ„ ν™•μΈν•  μ μμµλ‹λ‹¤.








